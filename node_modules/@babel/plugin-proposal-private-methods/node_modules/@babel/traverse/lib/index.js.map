{"version":3,"names":["visitors","_t","VISITOR_KEYS","removeProperties","traverseFast","cache","traverseNode","default","NodePath","Scope","Hub","traverse","parent","opts","scope","state","parentPath","noScope","type","Error","explode","verify","cheap","node","enter","path","skipKeys","clearNode","delete","tree","hasDenylistedType","has","stop","hasType","denylistTypes","includes","denylist"],"sources":["../src/index.ts"],"sourcesContent":["import * as visitors from \"./visitors\";\nimport {\n  VISITOR_KEYS,\n  removeProperties,\n  type RemovePropertiesOptions,\n  traverseFast,\n} from \"@babel/types\";\nimport type * as t from \"@babel/types\";\nimport * as cache from \"./cache\";\nimport type NodePath from \"./path\";\nimport type { default as Scope, Binding } from \"./scope\";\nimport type { Visitor } from \"./types\";\nimport { traverseNode } from \"./traverse-node\";\n\nexport type { Visitor, Binding };\nexport { default as NodePath } from \"./path\";\nexport { default as Scope } from \"./scope\";\nexport { default as Hub } from \"./hub\";\nexport type { HubInterface } from \"./hub\";\n\nexport { visitors };\n\nexport type TraverseOptions<S = t.Node> = {\n  scope?: Scope;\n  noScope?: boolean;\n  denylist?: string[];\n} & Visitor<S>;\n\nfunction traverse<S>(\n  parent: t.Node,\n  opts: TraverseOptions<S>,\n  scope: Scope | undefined,\n  state: S,\n  parentPath?: NodePath,\n): void;\n\nfunction traverse(\n  parent: t.Node,\n  opts: TraverseOptions,\n  scope?: Scope,\n  state?: any,\n  parentPath?: NodePath,\n): void;\n\nfunction traverse<Options extends TraverseOptions>(\n  parent: t.Node,\n  // @ts-expect-error provide {} as default value for Options\n  opts: Options = {},\n  scope?: Scope,\n  state?: any,\n  parentPath?: NodePath,\n) {\n  if (!parent) return;\n\n  if (!opts.noScope && !scope) {\n    if (parent.type !== \"Program\" && parent.type !== \"File\") {\n      throw new Error(\n        \"You must pass a scope and parentPath unless traversing a Program/File. \" +\n          `Instead of that you tried to traverse a ${parent.type} node without ` +\n          \"passing scope and parentPath.\",\n      );\n    }\n  }\n\n  if (!VISITOR_KEYS[parent.type]) {\n    return;\n  }\n\n  visitors.explode(opts as Visitor);\n\n  traverseNode(parent, opts, scope, state, parentPath);\n}\n\nexport default traverse;\n\ntraverse.visitors = visitors;\ntraverse.verify = visitors.verify;\ntraverse.explode = visitors.explode;\n\ntraverse.cheap = function (node: t.Node, enter: (node: t.Node) => void) {\n  traverseFast(node, enter);\n  return;\n};\n\ntraverse.node = function (\n  node: t.Node,\n  opts: TraverseOptions,\n  scope?: Scope,\n  state?: any,\n  path?: NodePath,\n  skipKeys?: Record<string, boolean>,\n) {\n  traverseNode(node, opts, scope, state, path, skipKeys);\n  // traverse.node always returns undefined\n};\n\ntraverse.clearNode = function (node: t.Node, opts?: RemovePropertiesOptions) {\n  removeProperties(node, opts);\n\n  cache.path.delete(node);\n};\n\ntraverse.removeProperties = function (\n  tree: t.Node,\n  opts?: RemovePropertiesOptions,\n) {\n  traverseFast(tree, traverse.clearNode, opts);\n  return tree;\n};\n\ntype HasDenylistedTypeState = {\n  has: boolean;\n  type: t.Node[\"type\"];\n};\nfunction hasDenylistedType(path: NodePath, state: HasDenylistedTypeState) {\n  if (path.node.type === state.type) {\n    state.has = true;\n    path.stop();\n  }\n}\n\ntraverse.hasType = function (\n  tree: t.Node,\n  type: t.Node[\"type\"],\n  denylistTypes?: Array<string>,\n): boolean {\n  // the node we're searching in is denylisted\n  if (denylistTypes?.includes(tree.type)) return false;\n\n  // the type we're looking for is the same as the passed node\n  if (tree.type === type) return true;\n\n  const state: HasDenylistedTypeState = {\n    has: false,\n    type: type,\n  };\n\n  traverse(\n    tree,\n    {\n      noScope: true,\n      denylist: denylistTypes,\n      enter: hasDenylistedType,\n    },\n    null,\n    state,\n  );\n\n  return state.has;\n};\n\ntraverse.cache = cache;\n"],"mappings":"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"}