{"version":3,"names":["skipAllButComputedKey","path","skip","node","computed","context","maybeQueue","get","requeueComputedKeyAndDecorators","decorators","decorator","visitor","FunctionParent","isArrowFunctionExpression","isMethod","Property","isObjectProperty"],"sources":["../src/index.ts"],"sourcesContent":["import type { NodePath, Visitor } from \"@babel/traverse\";\nimport type * as t from \"@babel/types\";\n\n// TODO (Babel 8): Don't export this function.\nexport function skipAllButComputedKey(\n  path: NodePath<t.Method | t.ClassProperty>,\n) {\n  path.skip();\n  if (path.node.computed) {\n    // requeue the computed key\n    path.context.maybeQueue(path.get(\"key\"));\n  }\n}\n\nexport function requeueComputedKeyAndDecorators(\n  path: NodePath<t.Method | t.Property>,\n) {\n  const { context, node } = path;\n  // @ts-expect-error ClassPrivateProperty does not have computed\n  if (node.computed) {\n    // requeue the computed key\n    context.maybeQueue(path.get(\"key\"));\n  }\n  if (node.decorators) {\n    for (const decorator of path.get(\"decorators\")) {\n      // requeue the decorators\n      context.maybeQueue(decorator);\n    }\n  }\n}\n\n// environmentVisitor should be used when traversing the whole class and not for specific class elements/methods.\n// For perf reasons, the environmentVisitor might be traversed with `{ noScope: true }`, which means `path.scope` is undefined.\n// Avoid using `path.scope` here\nconst visitor: Visitor = {\n  FunctionParent(path) {\n    if (path.isArrowFunctionExpression()) {\n      // arrows are not skipped because they inherit the context.\n      return;\n    } else {\n      path.skip();\n      if (path.isMethod()) {\n        requeueComputedKeyAndDecorators(path);\n      }\n    }\n  },\n  Property(path) {\n    if (path.isObjectProperty()) {\n      return;\n    }\n    path.skip();\n    requeueComputedKeyAndDecorators(path);\n  },\n};\n\nexport default visitor;\n"],"mappings":"AAIA,OAAO,SAASA,qBAAqBA,CACnCC,IAA0C,EAC1C;EACAA,IAAI,CAACC,IAAI,EAAE;EACX,IAAID,IAAI,CAACE,IAAI,CAACC,QAAQ,EAAE;IAEtBH,IAAI,CAACI,OAAO,CAACC,UAAU,CAACL,IAAI,CAACM,GAAG,CAAC,KAAK,CAAC,CAAC;EAC1C;AACF;AAEA,OAAO,SAASC,+BAA+BA,CAC7CP,IAAqC,EACrC;EACA,MAAM;IAAEI,OAAO;IAAEF;EAAK,CAAC,GAAGF,IAAI;EAE9B,IAAIE,IAAI,CAACC,QAAQ,EAAE;IAEjBC,OAAO,CAACC,UAAU,CAACL,IAAI,CAACM,GAAG,CAAC,KAAK,CAAC,CAAC;EACrC;EACA,IAAIJ,IAAI,CAACM,UAAU,EAAE;IACnB,KAAK,MAAMC,SAAS,IAAIT,IAAI,CAACM,GAAG,CAAC,YAAY,CAAC,EAAE;MAE9CF,OAAO,CAACC,UAAU,CAACI,SAAS,CAAC;IAC/B;EACF;AACF;AAKA,MAAMC,OAAgB,GAAG;EACvBC,cAAcA,CAACX,IAAI,EAAE;IACnB,IAAIA,IAAI,CAACY,yBAAyB,EAAE,EAAE;MAEpC;IACF,CAAC,MAAM;MACLZ,IAAI,CAACC,IAAI,EAAE;MACX,IAAID,IAAI,CAACa,QAAQ,EAAE,EAAE;QACnBN,+BAA+B,CAACP,IAAI,CAAC;MACvC;IACF;EACF,CAAC;EACDc,QAAQA,CAACd,IAAI,EAAE;IACb,IAAIA,IAAI,CAACe,gBAAgB,EAAE,EAAE;MAC3B;IACF;IACAf,IAAI,CAACC,IAAI,EAAE;IACXM,+BAA+B,CAACP,IAAI,CAAC;EACvC;AACF,CAAC;AAED,eAAeU,OAAO"}